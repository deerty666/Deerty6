<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…Ø®Ø²ÙˆÙ† Ø§Ù„Ù…Ø·Ø¹Ù… â€“ Ù…Ø¨Ø§Ø´Ø±</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
<style>
body{font-family:Cairo;background:#f4f4f4;margin:0;padding:15px}
h1{margin-bottom:10px}
.card{background:#fff;border-radius:14px;padding:12px;margin-bottom:10px;box-shadow:0 4px 10px rgba(0,0,0,.08)}
.off{opacity:.45}
.row{display:flex;justify-content:space-between;align-items:center;gap:8px;flex-wrap:wrap}
button{border:0;border-radius:8px;padding:6px 12px;cursor:pointer}
.green{background:#2ecc71;color:#fff}
.red{background:#e74c3c;color:#fff}
.gray{background:#7f8c8d;color:#fff}
input{width:70px;padding:6px;border-radius:6px;border:1px solid #ccc;text-align:center}
.admin{display:none}
.login input{width:100%;margin-bottom:6px}
</style>
</head>

<body>
<h1>ğŸ“¦ Ù…Ø®Ø²ÙˆÙ† Ø§Ù„Ù…Ø·Ø¹Ù…</h1>

<div id="login">
  <input id="email" placeholder="Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„">
  <input id="pass" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
  <button class="gray" onclick="login()">Ø¯Ø®ÙˆÙ„</button>
</div>

<div id="list"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, onSnapshot, doc, setDoc, updateDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
import { getAuth, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyCH3-skWKu3Z_6y9Y9D9dxOSLA4hGHBMBo",
  authDomain: "alraiee.firebaseapp.com", // Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø´ØªÙ‚Ø©
  projectId: "alraiee"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const auth = getAuth(app);

const ADMIN_EMAIL = "admin@restaurant.com";
const list = document.getElementById("list");

const defaultItems = [
 "Ø´ÙˆØ§ÙŠØ©","Ù…Ø¶Ø¨ÙŠ","Ù…Ù†Ø¯ÙŠ","Ù…Ø¸ØºÙˆØ·","Ù…Ù‚Ù„ÙˆØ¨Ø©","Ù…Ø¯ÙÙˆÙ†",
 "Ù„Ø­Ù… Ù…Ù†Ø¯ÙŠ ÙƒØ§Ù…Ù„","Ù„Ø­Ù… Ù…Ù†Ø¯ÙŠ Ù†Øµ","Ù„Ø­Ù… Ù…Ù†Ø¯ÙŠ Ø±Ø¨Ø¹","Ù„Ø­Ù… Ù…Ù†Ø¯ÙŠ Ù†ÙØ±",
 "Ù„Ø­Ù… Ø­Ø§Ø´ÙŠ","Ù„Ø­Ù… Ø¨Ø±Ù…Ø©",
 "Ø±Ø² Ø´Ø¹Ø¨ÙŠ","Ø±Ø² Ø¨Ø´Ø§ÙˆØ±","Ø±Ø² Ù…Ù†Ø¯ÙŠ",
 "Ø¬Ø±ÙŠØ´","Ù‚Ø±ØµØ§Ù†"
];

async function initItems(){
 for(const name of defaultItems){
  await setDoc(doc(db,"items",name),{name,qty:10,active:true},{merge:true});
 }
}
initItems();

onSnapshot(collection(db,"items"),snap=>{
 list.innerHTML="";
 snap.forEach(d=>{
  const i=d.data();
  const div=document.createElement("div");
  div.className="card"+(i.active?"":" off");
  div.innerHTML=`
   <div class="row">
    <strong>${i.name}</strong>
    <span>Ø§Ù„ÙƒÙ…ÙŠØ©: ${i.qty}</span>
   </div>
   <div class="row admin">
    <input type="number" value="${i.qty}" onchange="updateQty('${d.id}',this.value)">
    <button class="${i.active?'red':'green'}" onclick="toggle('${d.id}',${i.active})">
     ${i.active?'Ø¥ÙŠÙ‚Ø§Ù':'ØªØ´ØºÙŠÙ„'}
    </button>
   </div>`;
  list.appendChild(div);
 });
});

window.updateQty=(id,v)=>updateDoc(doc(db,"items",id),{qty:Number(v),active:v>0});
window.toggle=(id,s)=>updateDoc(doc(db,"items",id),{active:!s});

window.login=()=>{
 signInWithEmailAndPassword(auth,
  document.getElementById("email").value,
  document.getElementById("pass").value
 );
};

onAuthStateChanged(auth,u=>{
 if(u && u.email===ADMIN_EMAIL){
  document.getElementById("login").style.display="none";
  document.querySelectorAll(".admin").forEach(e=>e.style.display="flex");
 }
});
</script>
</body>
</html>
